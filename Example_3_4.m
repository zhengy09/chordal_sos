

%% Example 3.4
clc
syms x y z

P = [x^2*y^2 x*y+x^2*y^2-x*y^3 0; 
    x*y+x^2*y^2-x*y^3 2-y^2-z^2 y*z+y^2*z^2-y*z^3; 
    0 y*z+y^2*z^2-y*z^3 y^2*z^2];
g2 = 1 - y^2 - z^2;
g1 = 1 - x^2 - y^2;

S02 = [y^2 y^3*z+y^2*z^2;y^3*z+y^2*z^2 y^4*z^2+y^2*z^4];
S01 = [x^4*y^2+x^2*y^4 x^3*y+x^2*y^2;x^3*y+x^2*y^2 x^2];
S11 = [x^2*y^2 x*y; x*y 1];
S22 = [1 y*z;y*z y^2*z^2];

E1 = [1 0 0;0 1 0;];
E2 = [0 1 0;0 0 1];

E1'*(S01 + g1*S11)*E1 + E2'*(S02 + g2*S22)*E2
